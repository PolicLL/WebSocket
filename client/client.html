<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Game</title>
</head>
<body>
    <h2>WebSocket Game</h2>
    <div id="gameStatus"></div>
    <div id="yourNumbers"></div> <!-- Displays only the current player's numbers -->
    <input type="text" id="numberInput" placeholder="Enter your number" style="display:none;">
    <button id="submitBtn" onclick="submitChoice()" style="display:none;">Submit Number</button>
    <button onclick="startGame()">Start Game</button>

    <script>
        let socket;
        let gameStarted = false;
        let playerNumbers = []; // Will hold the player's numbers

        function startGame() {
            socket = new WebSocket("ws://localhost:8080/game");

            socket.onopen = function(event) {
                console.log("Connected to WebSocket server.");
            };

            socket.onmessage = function(event) {
                const message = event.data;
                document.getElementById("gameStatus").innerHTML = message;

                // Show the input field and submit button when prompted to choose a number
                if (message.includes("choose a number")) {
                    document.getElementById("numberInput").style.display = "inline";
                    document.getElementById("submitBtn").style.display = "inline";
                    document.getElementById("numberInput").focus();
                } else if (message.includes("wins") || message.includes("tie")) {
                    document.getElementById("numberInput").style.display = "none";
                    document.getElementById("submitBtn").style.display = "none"; // Hide button at the end
                }

                // If the message contains the player's numbers, display them
                if (message.includes("Your numbers")) {
                    let numbers = message.split(":")[1].trim();
                    playerNumbers = JSON.parse(numbers); // Parse the numbers
                    document.getElementById("yourNumbers").innerHTML = "Your numbers: " + playerNumbers.join(", ");
                }
            };

            socket.onclose = function(event) {
                console.log("Disconnected from WebSocket server.");
            };
        }

        // Submit the chosen number when the "Submit Number" button is clicked
        function submitChoice() {
            const chosenNumber = document.getElementById("numberInput").value.trim();
            if (chosenNumber && playerNumbers.includes(parseInt(chosenNumber))) {
                socket.send(chosenNumber);  // Send the chosen number to the server
                document.getElementById("numberInput").value = '';  // Clear the input field after submission
                document.getElementById("numberInput").style.display = "none";  // Hide the input field
                document.getElementById("submitBtn").style.display = "none";  // Hide the submit button after submission
            } else {
                alert("Please select a valid number from your list!");
            }
        }
    </script>
</body>
</html>
